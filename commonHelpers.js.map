{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// библиотеки\nimport SimpleLightbox from 'simplelightbox';\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from \"axios\";\n\n// api-key 40999949-91c7d6cea5390f79fde95dcf3\n\nconst searchForm = document.querySelector('.search');\nconst searchInput = document.querySelector('.input');\nconst loaderContainer = document.querySelector('.loader-container');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\n\nconst API_KEY = '40999949-91c7d6cea5390f79fde95dcf3';\n\nlet currentPage = 1;\nconst perPage = 40;\nlet searchQuery = '';\n\nfunction showLoader() {\n  loaderContainer.style.display = 'block';\n  loader.style.display = 'block';\n}\nfunction hideLoader() {\n  loaderContainer.style.display = 'none';\n  loader.style.display = 'none';\n}\n\nasync function searchImages(query, currentPage) {\n  // query = searchQuery;\n\n  const requestParams = {\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  };\n  const searchParams = new URLSearchParams(requestParams);\n\n  showLoader();\n\n    try {\n      const response = await axios.get(\n        `https://pixabay.com/api/?${searchParams}`\n      );\n\n    hideLoader();\n\n    const { hits, totalHits } = response.data;\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n      captionsData: 'alt',\n      close: true,\n    });\n\n    lightbox.refresh();\n\n    if (currentPage === 1) {\n      gallery.innerHTML = '';\n    }\n// function searchImages(query) {\n//   requestParams.q = query;\n\n\n//   fetch(`https://pixabay.com/api/?${searchParams}`)\n//     .then(response => {\n\n//       if (!response.ok) {\n//         throw new Error(\n//           'Sorry, there are no images matching your search query. Please try again!'\n//         );\n//       }\n//       return response.json();\n//     })\n\n//     .then(({ hits }) => {       \n\n//       const lightbox = new SimpleLightbox('.gallery a', {\n//         captionDelay: 250,\n//         captionsData: 'alt',\n//         close: true,\n//       });\n// ТУТ ПЕРЕПИСАТЬ ИЛИ УДАЛИТЬ\n\n      const galleryHtml = hits.reduce(\n        (html, image) =>\n          html +\n          `<a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img  \n                class=\"gallery-image\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n            />\n           <ul class=\"info-list\">\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Likes</p>\n                  <p class=\"info-value\">${image.likes}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Views</p>\n                  <p class=\"info-value\">${image.views}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Comments</p>\n                  <p class=\"info-value\">${image.comments}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Downloads</p>\n                  <p class=\"info-value\">${image.downloads}</p>\n              </li>\n            </ul>\n        </a>`,\n        ''\n      );\n      gallery.insertAdjacentHTML('beforeend', galleryHtml);\n      lightbox.refresh();\n\n      if (currentPage * perPage >= totalHits) {\n        loadMoreButton.style.display = 'none';\n        iziToast.error({\n          title: 'Error',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      } else {\n        loadMoreButton.style.display = 'block';\n        const scrollImages = document\n          .querySelector('.gallery-link')\n          .getBoundingClientRect().height;\n        window.scrollBy({\n          top: scrollImages * 2,\n          behavior: 'smooth',\n        });\n      }\n  } catch (error) {\n    hideLoader();\n\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n      position: 'topRight',\n    });\n  }\n}\n\n// LOAD MORE\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n\n  const query = searchInput.value.trim();\n  currentPage = 1;\n  loadMoreButton.style.display = 'none';\n  searchImages(query, currentPage);\n  searchForm.reset();\n});\nconst loadMoreButton = document.querySelector('.lm-button');\nloadMoreButton.addEventListener('click', () => {\n  currentPage += 1;\n  searchImages(searchQuery, currentPage);\n});"],"names":["searchForm","searchInput","loaderContainer","loader","gallery","API_KEY","currentPage","perPage","searchQuery","showLoader","hideLoader","searchImages","query","requestParams","searchParams","response","axios","hits","totalHits","lightbox","SimpleLightbox","galleryHtml","html","image","loadMoreButton","iziToast","scrollImages","error","event"],"mappings":"+vBASA,MAAMA,EAAa,SAAS,cAAc,SAAS,EAC7CC,EAAc,SAAS,cAAc,QAAQ,EAC7CC,EAAkB,SAAS,cAAc,mBAAmB,EAC5DC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAU,qCAEhB,IAAIC,EAAc,EAClB,MAAMC,EAAU,GAChB,IAAIC,EAAc,GAElB,SAASC,GAAa,CACpBP,EAAgB,MAAM,QAAU,QAChCC,EAAO,MAAM,QAAU,OACzB,CACA,SAASO,GAAa,CACpBR,EAAgB,MAAM,QAAU,OAChCC,EAAO,MAAM,QAAU,MACzB,CAEA,eAAeQ,EAAaC,EAAON,EAAa,CAG9C,MAAMO,EAAgB,CACpB,IAAKR,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMF,EACN,SAAUC,CACd,EACQO,EAAe,IAAI,gBAAgBD,CAAa,EAEtDJ,IAEE,GAAI,CACF,MAAMM,EAAW,MAAMC,EAAM,IAC3B,4BAA4BF,GACpC,EAEIJ,IAEA,KAAM,CAAE,KAAAO,EAAM,UAAAC,GAAcH,EAAS,KAC/BI,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,IACd,aAAc,MACd,MAAO,EACb,CAAK,EAEDD,EAAS,QAAO,EAEZb,IAAgB,IAClBF,EAAQ,UAAY,IA0BpB,MAAMiB,EAAcJ,EAAK,OACvB,CAACK,EAAMC,IACLD,EACA,iCAAiCC,EAAM;AAAA;AAAA;AAAA,uBAG1BA,EAAM;AAAA,uBACNA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,0CAKaA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA,cAIxC,EACR,EAIM,GAHAnB,EAAQ,mBAAmB,YAAaiB,CAAW,EACnDF,EAAS,QAAO,EAEZb,EAAcC,GAAWW,EAC3BM,EAAe,MAAM,QAAU,OAC/BC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6DACT,SAAU,UACpB,CAAS,MACI,CACLD,EAAe,MAAM,QAAU,QAC/B,MAAME,EAAe,SAClB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAe,EACpB,SAAU,QACpB,CAAS,CACF,CACJ,OAAQC,EAAP,CACAjB,IAEAe,EAAS,MAAM,CACb,MAAO,QACP,QAASE,EAAM,QACf,SAAU,UAChB,CAAK,CACF,CACH,CAIA3B,EAAW,iBAAiB,SAAU4B,GAAS,CAC7CA,EAAM,eAAc,EAEpB,MAAMhB,EAAQX,EAAY,MAAM,KAAI,EACpCK,EAAc,EACdkB,EAAe,MAAM,QAAU,OAC/Bb,EAAaC,EAAON,CAAW,EAC/BN,EAAW,MAAK,CAClB,CAAC,EACD,MAAMwB,EAAiB,SAAS,cAAc,YAAY,EAC1DA,EAAe,iBAAiB,QAAS,IAAM,CAC7ClB,GAAe,EACfK,EAAaH,EAAaF,CAAW,CACvC,CAAC"}